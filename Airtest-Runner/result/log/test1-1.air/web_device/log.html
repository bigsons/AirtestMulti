<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>执行报告</title>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/jquery-1.10.2.min.js"></script>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/jquery-lang.js" charset="utf-8" type="text/javascript"></script>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/langpack/zh_CN.js" charset="utf-8" type="text/javascript"></script>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/lazyload.js" charset="utf-8" type="text/javascript"></script>
    <link href="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/css/monokai_sublime.min.css" rel="stylesheet">
    
    <style type="text/css">
        /* Enhanced Report Theme - Inspired by Network Map UI */
        :root {
            /* Color Palette */
            --bg-color: #f4f4f4;
            --panel-bg: #ffffff; 
            --border-color: #e6e8eb;
            --primary-color: #4acbd6;
            --primary-hover-color: #1794bc;
            --active-color: #4acbd626;
            --active-text-color: #36444b;
            --text-color: #1d2529;
            --text-color-secondary: #a7a9ac;
            --success-color: #28a745;
            --fail-color: #dc3545;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            min-width: 600px;
        }

        .container-fluid {
            width: 90%; 
            max-width: 1400px;
            min-width: 800px;
            margin: 15px auto;
            background-color: var(--panel-bg);
            border-radius: 12px; /* 更大的圆角 */
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
            padding: 20px 30px;
        }

        .title {
            font-size: 28px;
            font-weight: 600;
            color: var(--text-color);
            text-align: center;
            padding-bottom: 15px;
            margin: 5px 0 15px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .summary {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .summary .info-block {
            flex: 1 1 300px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .summary .info-icon img {
            width: 48px;
            height: 48px;
        }
        
        .summary .info-text .info-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .summary .info-text .info-value {
            font-size: 14px;
            color: var(--text-color-secondary);
        }

        .summary .info-text .info-value strong {
            color: var(--text-color);
            font-weight: 500;
        }

        #result-desc {
            padding: 4px 12px;
            border-radius: 12px;
            color: #fff;
            font-size: 14px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        #result-desc.success { background-color: var(--success-color); }
        #result-desc.fail { background-color: var(--fail-color); }
        
        .copy-img {
            height: 15px;
            cursor: pointer;
            margin-left: 8px;
            vertical-align: middle;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        .copy-img:hover { opacity: 1; }

        .steps-wrapper {
            display: flex;
            gap: 5px;
            min-height: 500px;
            height: calc(100vh - 220px);
        }
        
        .step-panel-wrapper {
            border: 1px solid var(--border-color);
            border-radius: 10px; /* 更大的圆角 */
            background: var(--panel-bg);
            box-shadow: none; /* 移除内层阴影，整体更扁平 */
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .steps-left-wrapper {
            flex: 0 0 300px;
        }

        .steps-right-wrapper {
            flex: 1;
            min-width: 0;
        }
        
        .step-list { 
            list-style: none; 
            padding: 0; 
            margin: 0;
            overflow-y: auto;
            flex-grow: 1;
        }
        .step-list li {
            padding: 11px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
        }
        .step-list li:last-child {
            border-bottom: none;
        }
        .step-list li:hover { background-color: #f0f8ff; }
        /* --- 核心修改点：选中状态 --- */
        .step-list li.active { 
            background-color: var(--active-color); 
            color: var(--active-text-color); 
            font-weight: 600;
        }
        .step-list li.active .step-title, .step-list li.active .step-time { color: var(--active-text-color); }

        .step-list .step-icon {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .step-list .step-title {
            flex-grow: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .step-list .step-time {
            color: var(--text-color-secondary);
            font-size: 12px;
            white-space: nowrap;
            margin-left: 15px;
        }
        
        .step-panel-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #fafbfc; /* 更亮的头部背景 */
            flex-shrink: 0;
        }
        
        .step-title-display {
            font-size: 18px;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            min-width: 0;
        }
        
        .step-filters .filter {
            cursor: pointer;
            padding: 6px 16px;
            border-radius: 15px;
            margin-left: 10px;
            font-size: 13px;
            border: 1px solid #d9d9d9;
            transition: all 0.2s;
        }
        .step-filters .filter:hover {
            border-color: var(--primary-hover-color);
            color: var(--primary-hover-color);
        }
        .step-filters .filter.active {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }
        
        #jump-wrong {
            background-color: var(--fail-color);
            color: white;
            border-color: var(--fail-color);
            padding: 6px 16px;
            font-size: 13px;
        }
        
        #jump-wrong:hover {
            opacity: 0.85;
        }

        #jump-wrong.disabled {
            background-color: #ccc;
            border-color: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .step-detail-container {
            padding: 25px;
            overflow-y: auto;
            flex-grow: 1;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .step-detail-container::-webkit-scrollbar {
            display: none;
        }
        
        .step-detail {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .step-detail .step-info {
            display: grid;
            grid-template-columns: repeat(4, 1fr); 
            gap: 20px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .step-detail .info-item span { display: block; }
        .step-detail .info-item .label { color: var(--text-color-secondary); font-size: 14px;}
        .step-detail .info-item .value { font-weight: 500; font-size: 14px; }
        .step-detail .info-item .value.fail { color: var(--fail-color); }
        .step-detail .info-item .value.success { color: var(--success-color); }
        
        .step-detail .code-line, .step-detail .log-line, .step-detail .traceback, .step-detail .assert, .step-detail .args-line {
            margin-bottom: 20px;
        }
        
        .step-detail strong {
            display: block;
            margin-bottom: 10px;
            font-size: 15px;
            color: var(--text-color);
        }
        
        pre {
            padding: 15px;
            border-radius: 6px;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin: 0;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
            font-size: 13px;
            border: 1px solid #eee;
        }

        .step-detail .code-line pre { background-color: #fdfdfd; }
        .step-detail .log-line pre { background-color: #272822; color: #f8f8f2; }
        .step-detail .traceback pre { background-color: #fff0f6; color: var(--fail-color); border: 1px solid #ffadd2; } 
        .step-detail .assert { display: none; }
        
        .step-detail .fancybox {
            position: relative;
            display: inline-block;
            margin-top: 10px;
        }

        .step-detail img, .step-detail .crop_image {
            max-width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: zoom-in;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }

        .target {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            box-sizing: border-box;
        }
        
        .target::before, .target::after {
            content: '';
            display: block;
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 1px solid red; 
            transform: translate(-50%, -50%);
            animation: target-ripple 1.5s infinite ease-out;
        }
        
        .target::after { animation-delay: 0.5s; }

        .rect {
            position: absolute;
            border: 2px solid var(--fail-color);
            background-color: rgba(193, 28, 102, 0.2); /* 配合新的失败颜色 */
        }

        @keyframes target-ripple {
            from { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
            to { transform: translate(-50%, -50%) scale(2.5); opacity: 0; }
        }

        .footer { text-align: center; padding: 25px; color: var(--text-color-secondary); font-size: 12px; }

        #magnify {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.85); z-index: 1000;
            display: none; justify-content: center; align-items: center;
            cursor: zoom-out;
        }
        #magnify img { max-width: 95%; max-height: 95%; border: 2px solid #fff; border-radius: 5px; }

        @media (max-width: 1200px) {
            .container-fluid {
                width: 90%;
                min-width: 600px;
            }
        }

        @media (max-width: 992px) {
            .steps-wrapper { flex-direction: column; height: auto; gap: 20px; }
            .steps-left-wrapper { flex-basis: auto; max-height: 40vh; }
            .steps-right-wrapper { flex-basis: auto; max-height: 60vh; }
            .summary .info-block { flex-basis: 100%; }
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <h1 class="title" lang="en">Script Execution Report</h1>

        <div class="summary">
            <div class="info-block">
                <div class="info-icon">
                    <img id="result-img" src="" alt="result">
                </div>
                <div class="info-text">
                    <div class="info-title">
                        <span lang='en'>Test Result</span>
                        <label id='result-desc' lang="en"></label>
                    </div>
                    <div class="info-value">
                        <span lang="en">Steps: </span><strong>23</strong> &nbsp;&nbsp;
                        <span lang="en">Duration: </span><strong class="duration"></strong>
                    </div>
                </div>
            </div>
            <div class="info-block">
                <div class="info-icon">
                    <img src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/image/time.svg" alt="time">
                </div>
                <div class="info-text">
                    <div class="info-title"><span lang='en'>Execution Time</span></div>
                    <div class="info-value">
                        <span class="start-time"></span> - <span class="end-time"></span>
                    </div>
                </div>
            </div>
             <div class="info-block">
                <div class="info-icon">
                    <img src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/image/device.svg" alt="device">
                </div>
                <div class="info-text">
                    <div class="info-title"><span lang='en'>Device & Script</span></div>
                    <div class="info-value">
                        
                        <span title="C:\Users\Administrator\Desktop\AirtestMulti\Airtest-Runner\case\test1-1.air\test1-1.py">
                            <strong>Script: </strong>
                            test1-1.air
                            <img class="copy-img" data-value="C:\Users\Administrator\Desktop\AirtestMulti\Airtest-Runner\case\test1-1.air\test1-1.py" title="copy file path" src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/image/copy.svg" />
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="steps-wrapper">
            <div class="steps-left-wrapper step-panel-wrapper">
                <div class="step-panel-header">
                    <span class="step-title-display" lang="en">Steps</span>
                </div>
                <ul class="step-list"></ul>
                <div id="pageTool"></div>
            </div>
            <div class="steps-right-wrapper step-panel-wrapper">
                <div class="step-panel-header">
                    <div class="step-title-display">Step Details</div>
                    <div class="step-filters">
                        <span class="filter active" data-filter="all" lang="en">All</span>
                        <span class="filter" data-filter="success" lang="en">Success</span>
                        <span class="filter" data-filter="fail" lang="en">Fail</span>
                        <span class="filter" data-filter="assert" lang="en">Assert</span>
                        <span class="filter" id="jump-wrong" lang="en">Jump to Error</span>
                    </div>
                </div>
                <div class="step-detail-container">
                    <p>Select a step from the list on the left to see details.</p>
                </div>
            </div>
        </div>
    </div>
    
    <div id="magnify">
        <img src="">
    </div>
    
    <script type="text/javascript">
      var data = {"steps": [{"title": "serial_send", "time": 1758477832.6139135, "code": {"name": "serial_send", "args": [{"key": "command", "value": "aaaaa"}]}, "screen": null, "desc": "\u53d1\u9001\u547d\u4ee4: aaaaa", "traceback": "", "log": "\u4e32\u53e3\u672a\u6253\u5f00\uff0c\u8df3\u8fc7\u53d1\u9001\uff1aaaaaa", "assert": null}, {"title": "get", "time": 1758477834.7718756, "code": {"name": "get", "args": [{"key": "address", "value": "{a href='http://192.168.1.1' target='_blank' style='color:cornflowerblue'}http://192.168.1.1{/a}"}]}, "screen": {"src": "", "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u8bbf\u95ee\u7f51\u5740: http://192.168.1.1", "traceback": "", "log": "", "assert": null}, {"title": "serial_login", "time": 1758477834.7718756, "code": {"name": "serial_login", "args": [{"key": "password", "value": "79d05758"}, {"key": "username", "value": "root"}, {"key": "timeout", "value": 10}]}, "screen": null, "desc": "\u4e32\u53e3\u767b\u5f55: \"79d05758\"", "traceback": "", "log": "", "assert": null}, {"title": "serial_send", "time": 1758477834.7718756, "code": {"name": "serial_send", "args": [{"key": "command", "value": "ifconfig"}]}, "screen": null, "desc": "\u53d1\u9001\u547d\u4ee4: ifconfig", "traceback": "", "log": "\u4e32\u53e3\u672a\u6253\u5f00\uff0c\u8df3\u8fc7\u53d1\u9001\uff1aifconfig", "assert": null}, {"title": "Sleep", "time": 1758477835.7722416, "code": {"name": "sleep", "args": [{"key": "secs", "value": 1}]}, "screen": null, "desc": "\u7b49\u5f851\u79d2", "traceback": "", "log": "", "assert": null}, {"title": "serial_find", "time": 1758477835.7722416, "code": {"name": "serial_find", "args": [{"key": "pattern", "value": "192\\.168\\.1\\.1"}, {"key": "lines", "value": null}, {"key": "duration", "value": null}]}, "screen": null, "desc": "\u641c\u7d22\u4e32\u53e3: \"192\\.168\\.1\\.1\"\u6b63\u5219\u8868\u8fbe\u5f0f", "traceback": "", "log": "", "assert": null}, {"title": "serial_get", "time": 1758477835.7722416, "code": {"name": "serial_get", "args": [{"key": "lines", "value": 50}, {"key": "duration", "value": null}]}, "screen": null, "desc": "\u83b7\u53d6\u4e32\u53e3 50s/None\u884c\u5185Logs", "traceback": "", "log": "", "assert": null}, {"title": "wifi_disconnect", "time": 1758477835.7722416, "code": {"name": "wifi_disconnect", "args": []}, "screen": null, "desc": "\u65ad\u5f00WiFi\u8fde\u63a5", "traceback": "", "log": "\u5df2\u6210\u529f\u65ad\u5f00\u65e0\u7ebf", "assert": null}, {"title": "wifi_connect", "time": 1758477838.3123178, "code": {"name": "wifi_connect", "args": [{"key": "ssid", "value": "Redmi_9C67"}, {"key": "password", "value": "1169302692"}]}, "screen": null, "desc": "\u8fde\u63a5WiFi: Redmi_9C67", "traceback": "", "log": "\u5df2\u8fde\u63a5\u4e0a\u65e0\u7ebf:Redmi_9C67", "assert": null}, {"title": "Snapshot", "time": 1758477838.4393132, "code": {"name": "snapshot", "args": [{"key": "filename", "value": null}]}, "screen": {"src": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\result\\log\\test1-1.air\\web_device\\1758477838.png", "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u622a\u53d6\u5f53\u524d\u9875\u9762", "traceback": "", "log": "", "assert": null}, {"title": "assert_custom", "time": 1758477838.4531083, "code": {"name": "assert_custom", "args": [{"key": "param", "value": true}, {"key": "snap", "value": {"screen": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\result\\log\\test1-1.air\\web_device\\1758477838.png"}}, {"key": "msg", "value": " "}]}, "screen": {"src": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\result\\log\\test1-1.air\\web_device\\1758477838.png", "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u65ad\u8a00:  ", "traceback": "", "log": [], "assert": " "}, {"title": "serial_send", "time": 1758477838.4531083, "code": {"name": "serial_send", "args": [{"key": "command", "value": "rebowot"}]}, "screen": null, "desc": "\u53d1\u9001\u547d\u4ee4: rebowot", "traceback": "", "log": "\u4e32\u53e3\u672a\u6253\u5f00\uff0c\u8df3\u8fc7\u53d1\u9001\uff1arebowot", "assert": null}, {"title": "serial_send", "time": 1758477838.4531083, "code": {"name": "serial_send", "args": [{"key": "command", "value": "reboot"}]}, "screen": null, "desc": "\u53d1\u9001\u547d\u4ee4: reboot", "traceback": "", "log": "\u4e32\u53e3\u672a\u6253\u5f00\uff0c\u8df3\u8fc7\u53d1\u9001\uff1areboot", "assert": null}, {"title": "serial_get", "time": 1758477838.4531083, "code": {"name": "serial_get", "args": [{"key": "duration", "value": 10}, {"key": "lines", "value": null}]}, "screen": null, "desc": "\u83b7\u53d6\u4e32\u53e3 Nones/10\u884c\u5185Logs", "traceback": "", "log": "", "assert": null}, {"title": "\u4e32\u53e3\u65e5\u5fd7", "time": 1758477838.4531083, "code": null, "screen": null, "desc": null, "traceback": null, "log": "[]", "assert": null}, {"title": "get_ip", "time": 1758477838.4692137, "code": {"name": "get_ip", "args": [{"key": "interface_type", "value": null}]}, "screen": {"src": null, "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u83b7\u53d6\u65e0\u7ebf\u7f51\u5361IP", "traceback": "", "log": "\u5f53\u524dIP: 192.168.0.113", "assert": null}, {"title": "\u65e0\u7ebfip", "time": 1758477838.4692137, "code": null, "screen": null, "desc": null, "traceback": null, "log": "192.168.0.113", "assert": null}, {"title": "get_ip", "time": 1758477838.481618, "code": {"name": "get_ip", "args": [{"key": "interface_type", "value": "wired"}]}, "screen": {"src": null, "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u83b7\u53d6\u6709\u7ebf\u7f51\u5361IP", "traceback": "", "log": "\u5f53\u524dIP: 192.168.1.124", "assert": null}, {"title": "\u65e0\u7ebfip", "time": 1758477838.481618, "code": null, "screen": null, "desc": null, "traceback": null, "log": "192.168.1.124", "assert": null}, {"title": "ping", "time": 1758477842.5330052, "code": {"name": "ping", "args": [{"key": "ip_address", "value": "192.168.1.1"}, {"key": "count", "value": 5}]}, "screen": {"src": null, "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "Ping\u5730\u5740: 192.168.1.1", "traceback": "", "log": "", "assert": null}, {"title": "assert_custom", "time": 1758477842.6529412, "code": {"name": "assert_custom", "args": [{"key": "param", "value": true}, {"key": "snap", "value": true}, {"key": "msg", "value": "ping\u7ed3\u679c"}]}, "screen": {"src": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\result\\log\\test1-1.air\\web_device\\1758477842.png", "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u65ad\u8a00: ping\u7ed3\u679c", "traceback": "", "log": "{\n    \"packet_loss\": 0.0,\n    \"raw_output\": \"\\n\u6b63\u5728 Ping 192.168.1.1 \u5177\u6709 32 \u5b57\u8282\u7684\u6570\u636e:\\n\u6765\u81ea 192.168.1.1 \u7684\u56de\u590d: \u5b57\u8282=32 \u65f6\u95f4{1ms TTL=64\\n\u6765\u81ea 192.168.1.1 \u7684\u56de\u590d: \u5b57\u8282=32 \u65f6\u95f4{1ms TTL=64\\n\u6765\u81ea 192.168.1.1 \u7684\u56de\u590d: \u5b57\u8282=32 \u65f6\u95f4{1ms TTL=64\\n\u6765\u81ea 192.168.1.1 \u7684\u56de\u590d: \u5b57\u8282=32 \u65f6\u95f4{1ms TTL=64\\n\u6765\u81ea 192.168.1.1 \u7684\u56de\u590d: \u5b57\u8282=32 \u65f6\u95f4{1ms TTL=64\\n\\n192.168.1.1 \u7684 Ping \u7edf\u8ba1\u4fe1\u606f:\\n    \u6570\u636e\u5305: \u5df2\u53d1\u9001 = 5\uff0c\u5df2\u63a5\u6536 = 5\uff0c\u4e22\u5931 = 0 (0% \u4e22\u5931)\uff0c\\n\u5f80\u8fd4\u884c\u7a0b\u7684\u4f30\u8ba1\u65f6\u95f4(\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d):\\n    \u6700\u77ed = 0ms\uff0c\u6700\u957f = 0ms\uff0c\u5e73\u5747 = 0ms\\n\"\n}", "assert": "ping\u7ed3\u679c"}, {"title": "find_element_by_xpath", "time": 1758477862.7092595, "code": {"name": "find_element_by_xpath", "args": [{"key": "xpath", "value": "//input[@aria-required='true']"}]}, "screen": {"src": "", "rect": [], "pos": [], "vector": [], "confidence": null}, "desc": "\u5bfb\u627e\u9875\u9762\u5143\u7d20: \"//input[@aria-required='true']\"", "traceback": "Traceback (most recent call last):\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 106, in loop_find_element\n    element = func(by, text)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py\", line 926, in find_element\n    return self.execute(Command.FIND_ELEMENT, {\"using\": by, \"value\": value})[\"value\"]\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py\", line 458, in execute\n    self.error_handler.check_response(response)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\errorhandler.py\", line 232, in check_response\n    raise exception_class(message, screen, stacktrace)\nselenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {\"method\":\"xpath\",\"selector\":\"//input[@aria-required='true']\"}\n  (Session info: chrome=119.0.6045.200); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#nosuchelementexception\nStacktrace:\n\tGetHandleVerifier [0x00007FF780EF82B2+55298]\n\t(No symbol) [0x00007FF780E65E02]\n\t(No symbol) [0x00007FF780D205AB]\n\t(No symbol) [0x00007FF780D6175C]\n\t(No symbol) [0x00007FF780D618DC]\n\t(No symbol) [0x00007FF780D9CBC7]\n\t(No symbol) [0x00007FF780D820EF]\n\t(No symbol) [0x00007FF780D9AAA4]\n\t(No symbol) [0x00007FF780D81E83]\n\t(No symbol) [0x00007FF780D5670A]\n\t(No symbol) [0x00007FF780D57964]\n\tGetHandleVerifier [0x00007FF781270AAB+3694587]\n\tGetHandleVerifier [0x00007FF7812C728E+4048862]\n\tGetHandleVerifier [0x00007FF7812BF173+4015811]\n\tGetHandleVerifier [0x00007FF780F947D6+695590]\n\t(No symbol) [0x00007FF780E70CE8]\n\t(No symbol) [0x00007FF780E6CF34]\n\t(No symbol) [0x00007FF780E6D062]\n\t(No symbol) [0x00007FF780E5D3A3]\n\tBaseThreadInitThunk [0x00007FFCD1537374+20]\n\tRtlUserThreadStart [0x00007FFCD25FCC91+33]\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\__init__.py\", line 31, in wrapper\n    res = f(*args, **kwargs)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 228, in find_element_by_xpath\n    web_element = self.loop_find_element(super(WebChrome, self).find_element, xpath, by=By.XPATH)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 112, in loop_find_element\n    raise NoSuchElementException(\nselenium.common.exceptions.NoSuchElementException: Message: Element //input[@aria-required='true'] not found in screen; For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#nosuchelementexception\n\n", "log": "", "assert": null}, {"title": "Final Error", "time": 1758477862.7092595, "code": null, "screen": null, "desc": null, "traceback": "Traceback (most recent call last):\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 106, in loop_find_element\n    element = func(by, text)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py\", line 926, in find_element\n    return self.execute(Command.FIND_ELEMENT, {\"using\": by, \"value\": value})[\"value\"]\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\webdriver.py\", line 458, in execute\n    self.error_handler.check_response(response)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\selenium\\webdriver\\remote\\errorhandler.py\", line 232, in check_response\n    raise exception_class(message, screen, stacktrace)\nselenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {\"method\":\"xpath\",\"selector\":\"//input[@aria-required='true']\"}\n  (Session info: chrome=119.0.6045.200); For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#nosuchelementexception\nStacktrace:\n\tGetHandleVerifier [0x00007FF780EF82B2+55298]\n\t(No symbol) [0x00007FF780E65E02]\n\t(No symbol) [0x00007FF780D205AB]\n\t(No symbol) [0x00007FF780D6175C]\n\t(No symbol) [0x00007FF780D618DC]\n\t(No symbol) [0x00007FF780D9CBC7]\n\t(No symbol) [0x00007FF780D820EF]\n\t(No symbol) [0x00007FF780D9AAA4]\n\t(No symbol) [0x00007FF780D81E83]\n\t(No symbol) [0x00007FF780D5670A]\n\t(No symbol) [0x00007FF780D57964]\n\tGetHandleVerifier [0x00007FF781270AAB+3694587]\n\tGetHandleVerifier [0x00007FF7812C728E+4048862]\n\tGetHandleVerifier [0x00007FF7812BF173+4015811]\n\tGetHandleVerifier [0x00007FF780F947D6+695590]\n\t(No symbol) [0x00007FF780E70CE8]\n\t(No symbol) [0x00007FF780E6CF34]\n\t(No symbol) [0x00007FF780E6D062]\n\t(No symbol) [0x00007FF780E5D3A3]\n\tBaseThreadInitThunk [0x00007FFCD1537374+20]\n\tRtlUserThreadStart [0x00007FFCD25FCC91+33]\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\airtest\\cli\\runner.py\", line 72, in runTest\n    exec(compile(code.encode(\"utf-8\"), pyfilepath, 'exec'), self.scope)\n  File \"C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\case\\test1-1.air\\test1-1.py\", line 33, in {module}\n    driver.find_element_by_xpath(\"//input[@aria-required='true']\").send_keys(\"admin123\")\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\__init__.py\", line 31, in wrapper\n    res = f(*args, **kwargs)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 228, in find_element_by_xpath\n    web_element = self.loop_find_element(super(WebChrome, self).find_element, xpath, by=By.XPATH)\n  File \"C:\\Program Files\\Python39\\lib\\site-packages\\tp_airtest_selenium\\proxy.py\", line 112, in loop_find_element\n    raise NoSuchElementException(\nselenium.common.exceptions.NoSuchElementException: Message: Element //input[@aria-required='true'] not found in screen; For documentation on this error, please visit: https://www.selenium.dev/documentation/webdriver/troubleshooting/errors#nosuchelementexception\n\n", "log": "", "assert": null}], "name": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\case\\test1-1.air", "scale": 0.5, "test_result": false, "run_end": 1758477862.7092595, "run_start": 1758477832.6139135, "static_root": "C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/", "lang": "zh", "records": [], "info": {"name": "test1-1.air", "path": "C:\\Users\\Administrator\\Desktop\\AirtestMulti\\Airtest-Runner\\case\\test1-1.air\\test1-1.py", "author": "Administrator", "title": "", "desc": "", "devices": {}}, "log": "log.txt", "console": ""};
      var lang = new Lang();
      lang.init({
        defaultLang: 'en',
        currentLang: 'zh'
      });
    </script>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/highlight.min.js"></script>
    <script src="C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/js/paging.js"></script>
    
    <script type="text/javascript">
    
    var current_step_data = null; 

    function updateJumpButtonState() {
        var hasAnyErrors = $('.step-list li.fail').length > 0;
        var jumpButton = $('#jump-wrong');
        if (hasAnyErrors) {
            jumpButton.removeClass('disabled').prop('disabled', false);
        } else {
            jumpButton.addClass('disabled').prop('disabled', true);
        }
    }

    $(document).ready(function() {
        $.each(data.steps, function(index, step) {
            step.duration_ms = (index > 0) ? (step.time - data.steps[index - 1].time) * 1000 : (step.time - data.run_start) * 1000;
            step.duration = (step.duration_ms / 1000).toFixed(2) + 's';
        });

        var result = data.test_result ? 'success' : 'fail';
        $('#result-desc').addClass(result).text(result.charAt(0).toUpperCase() + result.slice(1));
        $('#result-img').attr('src', 'C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/image/' + result + '.svg');
        
        var startTime = new Date(data.run_start * 1000);
        var endTime = new Date(data.run_end * 1000);
        var total_duration = ((data.run_end - data.run_start)).toFixed(2) + 's';

        $('.start-time').text(startTime.toLocaleString());
        $('.end-time').text(endTime.toLocaleString());
        $('.summary .duration').text(total_duration);
        
        var step_list = $(".step-list");
        var has_assert = false;
        var currentWrong = -1;

        $.each(data.steps, function(index, step) {
            step.index = index;
            var step_class = step.traceback ? 'fail' : 'success';
            if (step.assert) {
                step_class += ' assert';
                has_assert = true;
            }
            var icon_src = 'C:/Users/Administrator/Desktop/AirtestMulti/Airtest-Runner/source/image/step_' + (step.traceback ? 'fail' : 'success') + '.svg';
            var title = step.desc || step.title || (step.code ? step.code.name : 'step ' + (index + 1));
            var time_str = new Date(step.time * 1000).toLocaleTimeString();

            var li = $('<li>').addClass(step_class).data('step-data', step);
            li.html('<img src="' + icon_src + '" class="step-icon">' +
                      '<span class="step-title">' + title + '</span>' +
                      '<span class="step-time">' + time_str + '</span>');
            step_list.append(li);
        });

        step_list.on('click', 'li', function() {
            step_list.find('li').removeClass('active');
            $(this).addClass('active');
            renderStepDetail($(this).data('step-data'));
        });
        
        $('.filter').on('click', function(){
            if ($(this).is('#jump-wrong')) return;
            $('.filter').removeClass('active');
            $(this).addClass('active');
            var filter = $(this).data('filter');
            
            step_list.find('li').show();
            if(filter !== 'all'){
                step_list.find('li:not(.' + filter + ')').hide();
            }
            
            var firstVisible = step_list.find('li:visible').first();
            if (firstVisible.length > 0) {
                 firstVisible.trigger('click');
            } else {
                 renderStepDetail(null);
            }
        });

        $('#jump-wrong').on('click', function() {
            if ($(this).hasClass('disabled')) return;
            var wrong_steps = step_list.find('li.fail:visible');
            
            if (wrong_steps.length > 0) {
                currentWrong = (currentWrong + 1) % wrong_steps.length;
                var target_step = $(wrong_steps[currentWrong]);
                target_step.click();
                 var container = $('.step-list');
                 container.scrollTop(
                    target_step.offset().top - container.offset().top + container.scrollTop() - 20
                 );
            } else {
                var all_wrong_steps = step_list.find('li.fail');
                if (all_wrong_steps.length > 0) {
                    $('.filter[data-filter="all"]').click();
                    currentWrong = 0;
                    var target_step = $(all_wrong_steps[currentWrong]);
                    target_step.click();
                    var container = $('.step-list');
                    container.scrollTop(
                        target_step.offset().top - container.offset().top + container.scrollTop() - 20
                    );
                }
            }
        });

        if(has_assert){
            $('.filter[data-filter="assert"]').trigger('click');
        } else {
            $('.filter[data-filter="all"]').trigger('click');
        }
        
        updateJumpButtonState(); 

        if (data.steps.length > 0) {
            step_list.find('li:visible').first().trigger('click');
        }
        
        $(document).on('click', '.step-detail img, .copy-img', function(e) {
            if ($(this).hasClass('copy-img')) {
                e.stopPropagation();
                var text_to_copy = $(this).data('value');
                var temp_input = $('<input>');
                $('body').append(temp_input);
                temp_input.val(text_to_copy).select();
                document.execCommand('copy');
                temp_input.remove();
            } else {
                $('#magnify img').attr('src', $(this).attr('src'));
                $('#magnify').css('display', 'flex');
            }
        });

        $('#magnify').on('click', function() {
            $(this).hide();
        });

        var resize_timer;
        $(window).on('resize', function() {
            clearTimeout(resize_timer);
            resize_timer = setTimeout(function() {
                if (current_step_data) {
                    updateMarkerPositions(current_step_data);
                }
            }, 200);
        });
    });

    function updateMarkerPositions(step) {
        if (step && step.screen && step.screen.src) {
            var fancybox = $('.step-detail .fancybox');
            var img = fancybox.find('img');

            if (img.length > 0 && img[0].naturalWidth > 0) { 
                var scale = img.width() / (step.screen.resolution ? step.screen.resolution[0] : img[0].naturalWidth);
                
                fancybox.find('.target').each(function(index) {
                    var pos = step.screen.pos[index];
                    $(this).css({
                        left: (pos[0] * scale - 10) + 'px',
                        top: (pos[1] * scale - 10) + 'px'
                    });
                });

                fancybox.find('.rect').each(function(index) {
                    var rect = step.screen.rect[index];
                    $(this).css({
                        left: rect.left * scale + 'px',
                        top: rect.top * scale + 'px',
                        width: rect.width * scale + 'px',
                        height: rect.height * scale + 'px'
                    });
                });
            }
        }
    }

    function renderStepDetail(step) {
        var detail_container = $(".step-detail-container");
        detail_container.empty();
        current_step_data = step;

        if(!step) {
            $('.steps-right-wrapper .step-title-display').text("Step Details").attr('title', 'Step Details');
            detail_container.html("<p>Select a step from the list on the left to see details.</p>");
            return;
        }
        
        var title = step.desc || step.title || (step.code ? step.code.name : 'step');
        $('.steps-right-wrapper .step-title-display').text(title).attr('title', title);
        
        var content = $('<div>').addClass('step-detail');

        var status_class = step.traceback ? 'fail' : 'success';
        var status_text = step.traceback ? 'Failed' : 'Success';
        var info_html = `
            <div class="step-info">
                <div class="info-item">
                    <span class="label">Step</span>
                    <span class="value">#${step.index + 1}</span>
                </div>
                <div class="info-item">
                    <span class="label">Status</span>
                    <span class="value ${status_class}">${status_text}</span>
                </div>
                <div class="info-item">
                    <span class="label">Action</span>
                    <span class="value">${step.code ? step.code.name : 'N/A'}</span>
                </div>
                <div class="info-item">
                    <span class="label">Duration</span>
                    <span class="value">${step.duration}</span>
                </div>
            </div>
        `;
        content.append(info_html);

        if (step.code) {
            var code_html = '<strong>Code:</strong><pre><code>' + step.code.name + '(';
            var args_list = [];
            if (step.code.args && step.code.args.length) {
                step.code.args.forEach(function(arg) {
                    var val = arg.value;
                    if (typeof val === 'object') val = JSON.stringify(val);
                    args_list.push('<span>' + arg.key + '</span>' + '=' + '<span>' + val + '</span>');
                });
            }
            code_html += args_list.join(', ') + ')</code></pre>';
            content.append($('<div>').addClass('code-line').html(code_html));
        }

        if (step.code && step.code.args && step.code.args.length > 0) {
            var args_content = $('<div>').addClass('args-line');
            var has_visible_args = false;
            
            args_content.append('<strong>Args:</strong>');

            step.code.args.forEach(function(arg) {
                if (arg.image) {
                    args_content.append('<div><img class="crop_image" src="' + arg.image + '" title="arg: ' + arg.key + '" onerror="this.parentElement.style.display=\'none\'"></div>');
                    has_visible_args = true;
                }
            });

            if(has_visible_args) {
                 content.append(args_content);
            }
        }
        
        if (step.screen && step.screen.src) {
            var fancybox = $('<div class="fancybox"></div>');
            var img = $('<img>').attr('src', step.screen.src).attr('onerror', "this.parentElement.style.display='none'");
            fancybox.append(img);

            img.on('load', function() {
                updateMarkerPositions(step);
            });
            content.append(fancybox);

            if(step.screen.pos && step.screen.pos.length){
                step.screen.pos.forEach(function(){
                    fancybox.append($('<div class="target"></div>'));
                });
            }
            if(step.screen.rect && step.screen.rect.length){
                step.screen.rect.forEach(function(){
                    fancybox.append($('<div class="rect"></div>'));
                });
            }
        }

        if (step.log) {
            var log_content = step.log;
            if (typeof log_content === 'object') {
                log_content = JSON.stringify(log_content, null, 2);
            }
            content.append($('<div>').addClass('log-line').html('<strong>Log:</strong><pre><code>' + log_content + '</code></pre>'));
        }

        if (step.traceback) {
             content.append($('<div>').addClass('traceback').html('<strong>Traceback:</strong><pre><code>' + step.traceback + '</code></pre>'));
        }
        
        if (step.assert) {
             content.append($('<div>').addClass('assert').html('<strong>Assert:</strong><pre>' + step.assert + '</pre>'));
        }
        
        detail_container.append(content);
        
        detail_container.find('.log-line pre code, .traceback pre code').each(function(i, block) {
            hljs.highlightBlock(block);
        });
    }
    </script>
</body>
</html>